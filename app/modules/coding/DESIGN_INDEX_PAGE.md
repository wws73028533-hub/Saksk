# 编程题主页设计方案

## 📋 文档信息

- **页面路径**: `/coding/index` 或 `/coding/`
- **设计版本**: v1.0
- **设计日期**: 2025-01-29
- **设计风格**: iOS 18 风格，毛玻璃效果，简约设计

---

## 🎯 设计目标

设计一个功能完整、体验优秀的编程题主页，提供：
- 清晰的题目浏览体验
- 强大的筛选和搜索功能
- 直观的统计信息展示
- 流畅的交互体验
- 响应式布局适配

---

## 🏗️ 页面结构设计

### 1. 整体布局

```
┌─────────────────────────────────────────────────┐
│  Header (页面标题 + 快捷操作)                      │
├─────────────────────────────────────────────────┤
│  Filters Card (筛选器卡片)                        │
│  ┌──────────┬──────────┬──────────┬──────────┐ │
│  │ 搜索框    │ 科目筛选  │ 难度筛选  │ 状态筛选  │ │
│  └──────────┴──────────┴──────────┴──────────┘ │
├─────────────────────────────────────────────────┤
│  Statistics Bar (统计信息栏 - 可选)                │
│  ┌──────────┬──────────┬──────────┬──────────┐ │
│  │ 总题目数  │ 已完成数  │ 进行中数  │ 通过率    │ │
│  └──────────┴──────────┴──────────┴──────────┘ │
├─────────────────────────────────────────────────┤
│  Questions Grid (题目卡片网格)                    │
│  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐ │
│  │ 题目1  │ │ 题目2  │ │ 题目3  │ │ 题目4  │ │
│  └────────┘ └────────┘ └────────┘ └────────┘ │
│  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐ │
│  │ 题目5  │ │ 题目6  │ │ 题目7  │ │ 题目8  │ │
│  └────────┘ └────────┘ └────────┘ └────────┘ │
├─────────────────────────────────────────────────┤
│  Pagination (分页器)                              │
└─────────────────────────────────────────────────┘
```

### 2. 组件详细设计

#### 2.1 Header（页面头部）

**功能**：
- 显示页面标题："编程题中心"
- 显示快捷操作按钮（可选）：
  - 提交历史链接
  - 统计页面链接
  - 主题切换按钮（深色/浅色模式）

**设计规范**：
- 标题：42px，字重700，负字间距-1px
- 右侧操作按钮：15px，字重500，圆角12px
- 毛玻璃背景效果

#### 2.2 Filters Card（筛选器卡片）

**功能模块**：
1. **搜索框**
   - 实时搜索（防抖500ms）
   - 占位符："搜索题目..."
   - 支持搜索题目标题和内容

2. **科目筛选**（新增）
   - 下拉选择框
   - 默认选项："全部"
   - 动态加载科目列表（从API获取）

3. **难度筛选**
   - 下拉选择框
   - 选项：全部 / 简单 / 中等 / 困难
   - 对应值："" / "easy" / "medium" / "hard"

4. **状态筛选**
   - 下拉选择框
   - 选项：全部 / 未开始 / 进行中 / 已通过
   - 对应值：all / unsolved / solving / solved

**设计规范**：
- 卡片背景：毛玻璃效果（backdrop-filter: blur(40px)）
- 圆角：18px
- 内边距：24px
- 筛选器间距：16px
- 输入框/选择框：圆角12px，边框0.5px

#### 2.3 Statistics Bar（统计信息栏 - 可选）

**功能**：
- 显示用户编程题练习统计
- 快速了解整体进度

**数据指标**：
- 总题目数
- 已完成数（已通过）
- 进行中数（有提交但未通过）
- 平均通过率

**设计规范**：
- 4个统计卡片，等宽分布
- 卡片样式：毛玻璃效果，圆角14px
- 数字：大号字体（32px），字重600
- 标签：小号字体（13px），次要文本颜色

#### 2.4 Questions Grid（题目卡片网格）

**布局**：
- 响应式网格布局
- 桌面端：每行3-4个卡片（minmax(320px, 1fr)）
- 平板端：每行2个卡片
- 移动端：每行1个卡片

**卡片内容**：
1. **题目标题**
   - 字体：20px，字重600
   - 颜色：主文本颜色
   - 最多显示2行，超出省略

2. **元信息标签**
   - 难度标签（颜色编码）：
     - 简单：绿色（#34c759）
     - 中等：橙色（#ff9500）
     - 困难：红色（#ff3b30）
   - 状态标签（可选）：
     - 未开始：灰色
     - 进行中：橙色
     - 已通过：绿色

3. **统计信息**
   - 通过率：百分比显示（如：75.5%）
   - 提交次数：数字显示
   - 科目名称（可选）

4. **交互效果**
   - 悬停：上移3px，阴影加深
   - 点击：跳转到题目详情页

**设计规范**：
- 卡片背景：毛玻璃效果
- 圆角：18px
- 内边距：24px
- 阴影：柔和阴影（0 8px 30px rgba(0, 0, 0, 0.06)）
- 悬停阴影：0 14px 44px rgba(0, 0, 0, 0.10)
- 过渡动画：0.24s ease

#### 2.5 Pagination（分页器）

**功能**：
- 显示当前页码
- 上一页/下一页按钮
- 页码跳转（显示当前页前后2页）
- 省略号显示（当页码过多时）

**设计规范**：
- 按钮圆角：12px
- 按钮内边距：8px 16px
- 激活状态：主色背景，白色文字
- 禁用状态：透明度0.5，不可点击

---

## 🎨 UI设计规范

### 颜色系统

**浅色模式**：
```css
--bg-color: #f5f5f7;                    /* 背景色 */
--card-bg: rgba(255, 255, 255, 0.72);   /* 卡片背景（毛玻璃） */
--card-bg-solid: rgba(255, 255, 255, 0.92); /* 卡片背景（实色） */
--text-color: #1d1d1f;                   /* 主文本 */
--text-sub: #6e6e73;                     /* 次要文本 */
--border-color: rgba(0, 0, 0, 0.06);     /* 边框颜色 */
--primary: #007AFF;                      /* 主色 */
--primary-light: rgba(0, 122, 255, 0.12); /* 主色浅色 */
--success: #34c759;                      /* 成功色（简单） */
--warning: #ff9500;                      /* 警告色（中等） */
--danger: #ff3b30;                       /* 危险色（困难） */
```

**深色模式**：
```css
--bg-color: #000000;                     /* 背景色 */
--card-bg: rgba(28, 28, 30, 0.6);        /* 卡片背景（毛玻璃） */
--card-bg-solid: rgba(28, 28, 30, 0.95); /* 卡片背景（实色） */
--text-color: #f5f5f7;                   /* 主文本 */
--text-sub: #a1a1a6;                     /* 次要文本 */
--border-color: rgba(255, 255, 255, 0.12); /* 边框颜色 */
--primary: #0a84ff;                      /* 主色 */
--primary-light: rgba(10, 132, 255, 0.2); /* 主色浅色 */
```

### 字体系统

**字体族**：
```css
font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 
             'SF Pro Text', 'Helvetica Neue', Arial, sans-serif;
```

**字体大小**：
- 页面标题：42px（字重700）
- 卡片标题：20px（字重600）
- 正文：15px（字重400）
- 标签：13px（字重500）
- 统计数字：32px（字重600）

### 圆角系统

```css
--radius-xl: 24px;  /* 大圆角（页面容器） */
--radius-lg: 18px;  /* 中圆角（卡片） */
--radius-md: 14px;  /* 小圆角（统计卡片） */
--radius-sm: 12px;  /* 极小圆角（按钮、输入框） */
```

### 阴影系统

```css
--shadow: 0 8px 30px rgba(0, 0, 0, 0.06);           /* 默认阴影 */
--shadow-hover: 0 14px 44px rgba(0, 0, 0, 0.10);   /* 悬停阴影 */
```

### 毛玻璃效果

```css
backdrop-filter: blur(40px) saturate(180%);
-webkit-backdrop-filter: blur(40px) saturate(180%);
```

---

## 🔄 交互设计

### 1. 加载状态

**初始加载**：
- 显示骨架屏或加载动画
- 文字提示："加载中..."

**加载失败**：
- 显示错误提示
- 提供"重试"按钮

### 2. 空状态

**无题目时**：
- 显示空状态插画（可选）
- 文字提示："暂无题目"
- 提供"刷新"按钮

**筛选无结果**：
- 文字提示："没有找到匹配的题目"
- 提供"清除筛选"按钮

### 3. 筛选交互

**实时搜索**：
- 输入防抖：500ms
- 输入时显示加载状态
- 筛选后重置到第一页

**下拉选择**：
- 选择后立即触发筛选
- 显示加载状态
- 筛选后重置到第一页

### 4. 分页交互

**页码跳转**：
- 点击页码跳转
- 跳转后滚动到顶部（平滑滚动）
- 显示加载状态

**上一页/下一页**：
- 禁用状态：当前页为第一页/最后一页时禁用
- 点击后平滑滚动到顶部

### 5. 卡片交互

**悬停效果**：
- 上移3px
- 阴影加深
- 过渡动画：0.24s ease

**点击效果**：
- 跳转到题目详情页：`/coding/<question_id>`
- 保持筛选状态（可选，通过URL参数）

---

## 📱 响应式设计

### 断点设置

```css
/* 移动端 */
@media (max-width: 768px) {
  /* 单列布局 */
  /* 字体缩小 */
  /* 内边距减小 */
}

/* 平板端 */
@media (min-width: 769px) and (max-width: 1024px) {
  /* 双列布局 */
}

/* 桌面端 */
@media (min-width: 1025px) {
  /* 多列布局（3-4列） */
}
```

### 移动端优化

1. **筛选器**：
   - 垂直堆叠
   - 全宽显示
   - 字体大小：15px

2. **题目卡片**：
   - 单列显示
   - 内边距：20px
   - 字体大小：18px（标题）

3. **分页器**：
   - 简化显示（仅显示上一页/下一页和当前页）
   - 按钮大小：44px（触摸友好）

---

## 🚀 性能优化

### 1. 前端优化

**防抖处理**：
- 搜索输入：500ms防抖
- 避免频繁API请求

**懒加载**：
- 图片懒加载（如果有题目标题图）
- 分页加载，不一次性加载所有数据

**缓存策略**：
- 科目列表缓存（LocalStorage）
- 筛选状态缓存（SessionStorage）

### 2. 后端优化

**API优化**：
- 分页查询，限制每页数量（默认20）
- 数据库索引优化（subject_id, difficulty, q_type）
- 统计信息缓存（可选）

**查询优化**：
- 使用参数化查询
- 避免N+1查询问题
- 统计信息批量计算

---

## 📊 数据流设计

### 1. 初始加载流程

```
页面加载
  ↓
检查登录状态
  ↓
并行请求：
  ├─ 加载科目列表（GET /coding/api/subjects）
  └─ 加载题目列表（GET /coding/api/questions?page=1）
  ↓
渲染页面
```

### 2. 筛选流程

```
用户操作筛选器
  ↓
更新筛选状态（filters对象）
  ↓
重置页码为1
  ↓
防抖处理（搜索框）
  ↓
发送API请求（GET /coding/api/questions?{filters}&page=1）
  ↓
更新题目列表
  ↓
更新分页器
```

### 3. 分页流程

```
用户点击页码
  ↓
更新currentPage
  ↓
发送API请求（GET /coding/api/questions?{filters}&page={currentPage}）
  ↓
更新题目列表
  ↓
平滑滚动到顶部
  ↓
更新分页器高亮
```

---

## 🔧 技术实现要点

### 1. API端点

**获取科目列表**（新增）：
```
GET /coding/api/subjects
Response: {
  "status": "success",
  "data": {
    "subjects": [
      {"id": 1, "name": "算法"},
      {"id": 2, "name": "数据结构"}
    ]
  }
}
```

**获取题目列表**（已存在）：
```
GET /coding/api/questions?subject={subject_id}&difficulty={difficulty}&status={status}&keyword={keyword}&page={page}&per_page={per_page}
```

### 2. 状态管理

**前端状态**：
```javascript
{
  currentPage: 1,
  perPage: 20,
  filters: {
    keyword: '',
    subject: '',
    difficulty: '',
    status: 'all'
  },
  subjects: [],  // 科目列表
  questions: [],  // 题目列表
  total: 0,      // 总题目数
  loading: false  // 加载状态
}
```

### 3. 关键函数

**加载科目列表**：
```javascript
async function loadSubjects() {
  try {
    const res = await fetch('/coding/api/subjects');
    const result = await res.json();
    if (result.status === 'success') {
      renderSubjectFilter(result.data.subjects);
    }
  } catch (error) {
    console.error('加载科目失败:', error);
  }
}
```

**加载题目列表**：
```javascript
async function loadQuestions(page = 1) {
  setLoading(true);
  try {
    const params = new URLSearchParams({
      page,
      per_page: perPage,
      ...filters
    });
    const res = await fetch(`/coding/api/questions?${params}`);
    const result = await res.json();
    if (result.status === 'success') {
      renderQuestions(result.data.questions);
      renderPagination(result.data);
    }
  } catch (error) {
    showError('加载失败，请刷新重试');
  } finally {
    setLoading(false);
  }
}
```

---

## ✅ 实现检查清单

### 功能实现
- [ ] 页面标题和头部
- [ ] 搜索框（防抖500ms）
- [ ] 科目筛选（下拉选择，动态加载）
- [ ] 难度筛选
- [ ] 状态筛选
- [ ] 题目卡片网格（响应式）
- [ ] 分页器
- [ ] 加载状态
- [ ] 空状态
- [ ] 错误处理

### UI设计
- [ ] iOS 18风格设计
- [ ] 毛玻璃效果
- [ ] 圆角系统
- [ ] 阴影系统
- [ ] 颜色系统（浅色/深色模式）
- [ ] 字体系统
- [ ] 响应式布局
- [ ] 动画过渡

### 性能优化
- [ ] 搜索防抖
- [ ] 分页加载
- [ ] 科目列表缓存
- [ ] 错误重试机制

### 交互体验
- [ ] 悬停效果
- [ ] 点击反馈
- [ ] 加载动画
- [ ] 平滑滚动
- [ ] 触摸友好（移动端）

---

## 📝 后续优化建议

1. **功能增强**：
   - 添加统计信息栏（显示用户整体进度）
   - 添加收藏功能（题目卡片显示收藏按钮）
   - 添加排序功能（按难度、通过率、提交次数排序）

2. **体验优化**：
   - 添加骨架屏加载效果
   - 添加空状态插画
   - 添加筛选状态持久化（URL参数）

3. **性能优化**：
   - 实现虚拟滚动（如果题目数量很大）
   - 添加服务端缓存
   - 优化数据库查询

---

**文档版本**: v1.0  
**创建日期**: 2025-01-29  
**维护者**: 开发团队









































