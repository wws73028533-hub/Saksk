# ç¼–ç¨‹é¢˜æ¨¡å—å¼€å‘æ–‡æ¡£

## ğŸ“‹ ç›®å½•

- [æ¨¡å—æ¦‚è¿°](#æ¨¡å—æ¦‚è¿°)
- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
- [ç›®å½•ç»“æ„](#ç›®å½•ç»“æ„)
- [é¡µé¢è·¯ç”±](#é¡µé¢è·¯ç”±)
- [APIæ¥å£](#apiæ¥å£)
- [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
- [æ ¸å¿ƒåŠŸèƒ½å®ç°](#æ ¸å¿ƒåŠŸèƒ½å®ç°)
- [UIè®¾è®¡è§„èŒƒ](#uiè®¾è®¡è§„èŒƒ)
- [ä½¿ç”¨æŒ‡å—](#ä½¿ç”¨æŒ‡å—)
- [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
- [æ›´æ–°æ—¥å¿—](#æ›´æ–°æ—¥å¿—)

---

## æ¨¡å—æ¦‚è¿°

ç¼–ç¨‹é¢˜æ¨¡å—æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åœ¨çº¿ç¼–ç¨‹ç»ƒä¹ å¹³å°ï¼Œæä¾›å®Œæ•´çš„ç¼–ç¨‹é¢˜ç›®æµè§ˆã€åœ¨çº¿ä»£ç ç¼–è¾‘ã€è‡ªåŠ¨åˆ¤é¢˜ã€æäº¤å†å²æŸ¥çœ‹ã€å¾—åˆ†ç»Ÿè®¡å’Œæ’ååŠŸèƒ½ã€‚

### è®¾è®¡åŸåˆ™

- **ç‹¬ç«‹æ€§**ï¼šå®Œå…¨ç‹¬ç«‹çš„åŠŸèƒ½æ¨¡å—ï¼Œæ‹¥æœ‰ç‹¬ç«‹çš„æ•°æ®è¡¨ï¼ˆ`coding_subjects`ã€`coding_questions`ï¼‰ï¼Œä¸ä¸é¢˜åº“ä¸­å¿ƒï¼ˆ`subjects`ã€`questions`ï¼‰æ··åˆ
- **æ¨¡å—åŒ–**ï¼šé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæ¯ä¸ªåŠŸèƒ½å­æ¨¡å—éƒ½æœ‰ç‹¬ç«‹çš„æ–‡ä»¶å¤¹
- **å¯æ‰©å±•æ€§**ï¼šæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼ˆåˆæœŸæ”¯æŒPythonï¼Œåç»­å¯æ‰©å±•Javaã€C++ç­‰ï¼‰
- **å®‰å…¨æ€§**ï¼šä»£ç æ‰§è¡Œé‡‡ç”¨æ²™ç®±ç¯å¢ƒï¼Œé˜²æ­¢æ¶æ„ä»£ç æ‰§è¡Œ
- **æ•°æ®å®Œæ•´æ€§**ï¼šæ‰€æœ‰æäº¤è®°å½•å’Œå¾—åˆ†éƒ½æŒä¹…åŒ–ä¿å­˜åˆ°æ•°æ®åº“

### æŠ€æœ¯æ ˆ

- **åç«¯**ï¼šFlask + Flask-RESTful + Pydantic
- **å‰ç«¯**ï¼šåŸç”ŸHTML/CSS/JavaScript + Monaco Editorï¼ˆä»£ç ç¼–è¾‘å™¨ï¼‰
- **ä»£ç æ‰§è¡Œ**ï¼šPython subprocessï¼ˆå¼€å‘ç¯å¢ƒï¼‰/ Dockerï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- **æ•°æ®åº“**ï¼šSQLiteï¼ˆé€šè¿‡ `app.core.utils.database.get_db()` è®¿é—®ï¼‰
- **UIé£æ ¼**ï¼šiOS 18é£æ ¼ï¼Œæ¯›ç»ç’ƒæ•ˆæœï¼Œç®€çº¦è®¾è®¡ï¼Œå‚è€ƒPTAå¹³å°å¸ƒå±€

---

## åŠŸèƒ½ç‰¹æ€§

### ç”¨æˆ·ç«¯åŠŸèƒ½

1. **é¢˜ç›®é›†åˆ—è¡¨é¡µ** (`/coding` æˆ– `/coding/index`)
   - æ˜¾ç¤ºæ‰€æœ‰é¢˜ç›®é›†ï¼ˆç§‘ç›®ï¼‰åˆ—è¡¨
   - æ˜¾ç¤ºæ¯ä¸ªé¢˜ç›®é›†çš„ç»Ÿè®¡ä¿¡æ¯ï¼ˆæ€»é¢˜æ•°ã€å·²è§£å†³ã€é€šè¿‡ç‡ï¼‰
   - æ”¯æŒæœç´¢ã€æ’åºï¼ˆæœ€æ–°åˆ›å»ºã€æŒ‰æ ‡é¢˜ï¼‰
   - æ˜¾ç¤ºé¢˜ç›®é›†çŠ¶æ€ï¼ˆå¼€æ”¾/æœªå¼€æ”¾ï¼‰

2. **é¢˜ç›®é›†æ¦‚è¿°é¡µ** (`/coding/subject/<subject_id>`)
   - æ˜¾ç¤ºé¢˜ç›®é›†è¯¦ç»†ä¿¡æ¯
   - æ˜¾ç¤ºç­”é¢˜ä¿¡æ¯ï¼ˆå¾—åˆ†ã€æ’åã€è¿›åº¦ï¼‰
   - æ˜¾ç¤ºé¢˜ç›®ç»Ÿè®¡ï¼ˆæŒ‰éš¾åº¦åˆ†ç±»ï¼šç®€å•/ä¸­ç­‰/å›°éš¾ï¼‰
   - æ˜¾ç¤ºæ—¶é—´çº¿å’Œè¿›åº¦è¡¨
   - æ˜¾ç¤ºç”¨æˆ·åœ¨è¯¥é¢˜ç›®é›†çš„æ’å

3. **é¢˜ç›®åˆ—è¡¨é¡µ** (`/coding/questions?subject=<subject_id>`)
   - æ˜¾ç¤ºæŒ‡å®šç§‘ç›®ä¸‹çš„æ‰€æœ‰é¢˜ç›®
   - æ”¯æŒæŒ‰éš¾åº¦ã€çŠ¶æ€ç­›é€‰
   - æ”¯æŒæœç´¢åŠŸèƒ½
   - æ˜¾ç¤ºé¢˜ç›®å®ŒæˆçŠ¶æ€ï¼ˆæœªå¼€å§‹/è¿›è¡Œä¸­/å·²é€šè¿‡ï¼‰

4. **é¢˜ç›®è¯¦æƒ…é¡µ** (`/coding/<question_id>`)
   - ä¸‰æ å¸ƒå±€ï¼šå·¦ä¾§å¯¼èˆªã€ä¸­é—´é¢˜ç›®æè¿°ã€å³ä¾§ä»£ç ç¼–è¾‘å™¨
   - å·¦ä¾§å¯¼èˆªæ å¯æ”¶èµ·/å±•å¼€ï¼ˆå›¾æ ‡+æ–‡å­—å¸ƒå±€ï¼‰
   - æ˜¾ç¤ºé¢˜ç›®å®Œæ•´ä¿¡æ¯ï¼ˆæè¿°ã€ç¤ºä¾‹ã€çº¦æŸæ¡ä»¶ï¼‰
   - é›†æˆMonaco Editorä»£ç ç¼–è¾‘å™¨
   - æ”¯æŒä»£ç è¿è¡Œï¼ˆæµ‹è¯•ç”¨ä¾‹ï¼‰å’Œæäº¤ï¼ˆè‡ªåŠ¨åˆ¤é¢˜ï¼‰
   - ä»£ç è‡ªåŠ¨ä¿å­˜åˆ°LocalStorage
   - æ”¯æŒä¸Šä¸€é¢˜/ä¸‹ä¸€é¢˜å¯¼èˆª
   - æ˜¾ç¤ºæäº¤ç»“æœå’Œå¾—åˆ†

5. **æäº¤å†å²é¡µ** (`/coding/submissions?question=<question_id>&subject=<subject_id>`)
   - æ˜¾ç¤ºå½“å‰ç”¨æˆ·å¯¹æŒ‡å®šé¢˜ç›®æˆ–ç§‘ç›®çš„æ‰€æœ‰æäº¤è®°å½•
   - æ˜¾ç¤ºæäº¤çŠ¶æ€ã€é€šè¿‡æµ‹è¯•ç”¨ä¾‹æ•°ã€å¾—åˆ†ã€æ‰§è¡Œæ—¶é—´
   - æ”¯æŒæŸ¥çœ‹é¢˜ç›®è¯¦æƒ…

6. **æ’åé¡µ** (`/coding/statistics?question=<question_id>&subject=<subject_id>`)
   - æ˜¾ç¤ºæŒ‡å®šé¢˜ç›®çš„ç”¨æˆ·æ’å
   - æŒ‰å¾—åˆ†ï¼ˆé€šè¿‡ç‡ï¼‰æ’åºï¼Œç›¸åŒå¾—åˆ†æŒ‰æ‰§è¡Œæ—¶é—´æ’åº
   - é«˜äº®æ˜¾ç¤ºå‰ä¸‰åï¼ˆé‡‘ã€é“¶ã€é“œï¼‰
   - æ˜¾ç¤ºå½“å‰ç”¨æˆ·æ’åå’Œæœ€ä½³å¾—åˆ†

### ç®¡ç†ç«¯åŠŸèƒ½

1. **ç¼–ç¨‹ç®¡ç†ä¸»é¡µ** (`/admin/coding`)
   - é›†æˆé¢˜ç›®é›†ç®¡ç†å’Œé¢˜ç›®ç®¡ç†çš„ç»Ÿä¸€å…¥å£
   - æ ‡ç­¾é¡µåˆ‡æ¢ï¼šé¢˜ç›®é›†ç®¡ç† / é¢˜ç›®ç®¡ç†

2. **é¢˜ç›®é›†ç®¡ç†** (`/admin/coding/subjects`)
   - é¢˜ç›®é›†åˆ—è¡¨ï¼ˆè¡¨æ ¼å±•ç¤ºï¼‰
   - åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤é¢˜ç›®é›†
   - æ˜¾ç¤ºæ¯ä¸ªé¢˜ç›®é›†çš„é¢˜ç›®æ•°é‡ï¼ˆå‡½æ•°é¢˜/ç¼–ç¨‹é¢˜/æ€»è®¡ï¼‰
   - æ”¯æŒé”å®š/è§£é”é¢˜ç›®é›†

3. **é¢˜ç›®ç®¡ç†** (`/admin/coding/questions`)
   - é¢˜ç›®åˆ—è¡¨ï¼ˆè¡¨æ ¼å±•ç¤ºï¼‰
   - åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤é¢˜ç›®
   - æ”¯æŒæŒ‰é¢˜ç›®é›†ã€é¢˜ç›®ç±»å‹ï¼ˆå‡½æ•°é¢˜/ç¼–ç¨‹é¢˜ï¼‰ã€éš¾åº¦ç­›é€‰
   - æ‰¹é‡æ“ä½œï¼ˆåˆ é™¤ã€å¯¼å‡ºï¼‰
   - é¢˜ç›®çŠ¶æ€ç®¡ç†ï¼ˆå¯ç”¨/ç¦ç”¨ï¼‰
   - æ˜¾ç¤ºé¢˜ç›®ç»Ÿè®¡ï¼ˆæäº¤æ¬¡æ•°ã€é€šè¿‡ç‡ï¼‰

---

## æŠ€æœ¯æ¶æ„

### æ¶æ„åˆ†å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å‰ç«¯å±‚ (Templates)          â”‚
â”‚  HTML + CSS + JavaScript + Monaco  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         è·¯ç”±å±‚ (Routes)             â”‚
â”‚   pages.py (é¡µé¢è·¯ç”±)               â”‚
â”‚   api.py (APIè·¯ç”±)                  â”‚
â”‚   admin.py (ç®¡ç†ç«¯è·¯ç”±)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æœåŠ¡å±‚ (Services)           â”‚
â”‚   QuestionService                   â”‚
â”‚   SubmissionService                 â”‚
â”‚   JudgeService                      â”‚
â”‚   CodeExecutor                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ•°æ®å±‚ (Database)            â”‚
â”‚   coding_subjects                   â”‚
â”‚   coding_questions                  â”‚
â”‚   code_submissions                  â”‚
â”‚   coding_statistics                 â”‚
â”‚   user_coding_stats                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®éªŒè¯

ä½¿ç”¨ **Pydantic** è¿›è¡Œæ•°æ®éªŒè¯å’Œåºåˆ—åŒ–ï¼š

- `ExecuteCodeSchema` - ä»£ç æ‰§è¡Œè¯·æ±‚éªŒè¯
- `SubmitCodeSchema` - ä»£ç æäº¤è¯·æ±‚éªŒè¯
- `QuestionCreateSchema` - é¢˜ç›®åˆ›å»ºè¯·æ±‚éªŒè¯
- `QuestionUpdateSchema` - é¢˜ç›®æ›´æ–°è¯·æ±‚éªŒè¯

---

## ç›®å½•ç»“æ„

```
app/modules/coding/
â”œâ”€â”€ __init__.py                 # æ¨¡å—åˆå§‹åŒ–
â”œâ”€â”€ routes/                     # è·¯ç”±å±‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ pages.py                # é¡µé¢è·¯ç”±ï¼ˆç”¨æˆ·ç«¯ï¼‰
â”‚   â”œâ”€â”€ api.py                  # APIè·¯ç”±ï¼ˆç”¨æˆ·ç«¯ï¼‰
â”‚   â””â”€â”€ admin.py                # ç®¡ç†ç«¯è·¯ç”±ï¼ˆé¡µé¢+APIï¼‰
â”œâ”€â”€ services/                   # æœåŠ¡å±‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ question_service.py     # é¢˜ç›®æœåŠ¡ï¼ˆCRUDã€æŸ¥è¯¢ï¼‰
â”‚   â”œâ”€â”€ submission_service.py   # æäº¤æœåŠ¡ï¼ˆæäº¤è®°å½•ã€ç»Ÿè®¡ï¼‰
â”‚   â”œâ”€â”€ judge_service.py        # åˆ¤é¢˜æœåŠ¡ï¼ˆæµ‹è¯•ç”¨ä¾‹éªŒè¯ï¼‰
â”‚   â””â”€â”€ code_executor.py        # ä»£ç æ‰§è¡ŒæœåŠ¡
â”œâ”€â”€ models/                     # æ•°æ®æ¨¡å‹å±‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ coding_question.py      # ç¼–ç¨‹é¢˜æ¨¡å‹
â”‚   â””â”€â”€ code_submission.py      # ä»£ç æäº¤æ¨¡å‹
â”œâ”€â”€ schemas/                    # æ•°æ®éªŒè¯å±‚ï¼ˆPydanticï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ question_schemas.py     # é¢˜ç›®ç›¸å…³Schema
â”‚   â””â”€â”€ submission_schemas.py   # æäº¤ç›¸å…³Schema
â””â”€â”€ templates/                  # æ¨¡æ¿æ–‡ä»¶
    â”œâ”€â”€ coding/
    â”‚   â”œâ”€â”€ index.html          # é¢˜ç›®é›†åˆ—è¡¨é¡µ
    â”‚   â”œâ”€â”€ subject_overview.html  # é¢˜ç›®é›†æ¦‚è¿°é¡µ
    â”‚   â”œâ”€â”€ questions.html       # é¢˜ç›®åˆ—è¡¨é¡µ
    â”‚   â”œâ”€â”€ detail.html          # é¢˜ç›®è¯¦æƒ…é¡µ
    â”‚   â”œâ”€â”€ submissions.html     # æäº¤å†å²é¡µ
    â”‚   â””â”€â”€ statistics.html     # æ’åé¡µ
    â””â”€â”€ admin/
        â””â”€â”€ coding/
            â”œâ”€â”€ dashboard.html   # ç¼–ç¨‹ç®¡ç†ä¸»é¡µ
            â”œâ”€â”€ subjects.html     # é¢˜ç›®é›†ç®¡ç†é¡µ
            â””â”€â”€ questions.html    # é¢˜ç›®ç®¡ç†é¡µ
```

---

## é¡µé¢è·¯ç”±

### ç”¨æˆ·ç«¯è·¯ç”±

| è·¯ç”± | æ–¹æ³• | è¯´æ˜ | æ¨¡æ¿æ–‡ä»¶ |
|------|------|------|----------|
| `/coding` æˆ– `/coding/index` | GET | é¢˜ç›®é›†åˆ—è¡¨é¡µ | `index.html` |
| `/coding/subject/<subject_id>` | GET | é¢˜ç›®é›†æ¦‚è¿°é¡µ | `subject_overview.html` |
| `/coding/questions` | GET | é¢˜ç›®åˆ—è¡¨é¡µï¼ˆæ”¯æŒ`?subject=<id>`ç­›é€‰ï¼‰ | `questions.html` |
| `/coding/<question_id>` | GET | é¢˜ç›®è¯¦æƒ…é¡µ | `detail.html` |
| `/coding/submissions` | GET | æäº¤å†å²é¡µï¼ˆæ”¯æŒ`?question=<id>&subject=<id>`ç­›é€‰ï¼‰ | `submissions.html` |
| `/coding/statistics` | GET | æ’åé¡µï¼ˆæ”¯æŒ`?question=<id>&subject=<id>`ç­›é€‰ï¼‰ | `statistics.html` |

### ç®¡ç†ç«¯è·¯ç”±

| è·¯ç”± | æ–¹æ³• | è¯´æ˜ | æ¨¡æ¿æ–‡ä»¶ |
|------|------|------|----------|
| `/admin/coding` | GET | ç¼–ç¨‹ç®¡ç†ä¸»é¡µï¼ˆé›†æˆå…¥å£ï¼‰ | `dashboard.html` |
| `/admin/coding/subjects` | GET | é¢˜ç›®é›†ç®¡ç†é¡µ | `subjects.html` |
| `/admin/coding/questions` | GET | é¢˜ç›®ç®¡ç†é¡µï¼ˆæ”¯æŒ`?subject=<id>`ç­›é€‰ï¼‰ | `questions.html` |

---

## APIæ¥å£

### åŸºç¡€URL

- ç”¨æˆ·ç«¯APIå‰ç¼€ï¼š`/coding/api`
- ç®¡ç†ç«¯APIå‰ç¼€ï¼š`/admin/coding/api`

### ç§‘ç›®ç›¸å…³API

#### 1. è·å–ç§‘ç›®åˆ—è¡¨

```
GET /coding/api/subjects
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "status": "success",
  "data": {
    "subjects": [
      {"id": 1, "name": "ç®—æ³•"},
      {"id": 2, "name": "Python"}
    ]
  }
}
```

#### 2. è·å–ç§‘ç›®ç»Ÿè®¡ä¿¡æ¯

```
GET /coding/api/subjects/stats
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "status": "success",
  "data": {
    "subjects": [
      {
        "id": 1,
        "name": "ç®—æ³•",
        "total_questions": 50,
        "solved_questions": 20,
        "total_submissions": 150,
        "progress_rate": 40.0
      }
    ]
  }
}
```

#### 3. è·å–é¢˜ç›®é›†æ¦‚è¿°

```
GET /coding/api/subjects/<subject_id>/overview
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "status": "success",
  "data": {
    "subject": {
      "id": 1,
      "name": "ç®—æ³•",
      "description": "ç®—æ³•é¢˜ç›®é›†"
    },
    "question_stats": {
      "total": 50,
      "solved": 20,
      "total_submissions": 150,
      "difficulty_stats": {
        "easy": {"total": 20, "solved": 10},
        "medium": {"total": 20, "solved": 8},
        "hard": {"total": 10, "solved": 2}
      }
    },
    "user_stats": {
      "score": 20,
      "solved_count": 20,
      "rank": 5,
      "total_participants": 100,
      "first_submitted_at": "2025-01-29 10:30:00",
      "progress_rate": 40.0
    },
    "status": {
      "is_open": true,
      "type": "fixed",
      "set_type": "normal"
    }
  }
}
```

### é¢˜ç›®ç›¸å…³API

#### 4. è·å–é¢˜ç›®åˆ—è¡¨

```
GET /coding/api/questions?subject=<id>&difficulty=<level>&status=<status>&keyword=<keyword>&page=<page>&per_page=<per_page>
```

**æŸ¥è¯¢å‚æ•°ï¼š**
- `subject` (å¯é€‰): ç§‘ç›®ID
- `difficulty` (å¯é€‰): éš¾åº¦ï¼ˆeasy/medium/hardï¼‰
- `status` (å¯é€‰): çŠ¶æ€ï¼ˆall/unsolved/solving/solvedï¼‰
- `keyword` (å¯é€‰): æœç´¢å…³é”®è¯
- `page` (å¯é€‰): é¡µç ï¼Œé»˜è®¤1
- `per_page` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "status": "success",
  "data": {
    "questions": [
      {
        "id": 1,
        "title": "ä¸¤æ•°ä¹‹å’Œ",
        "subject_name": "ç®—æ³•",
        "difficulty": "easy",
        "acceptance_rate": 0.75,
        "total_submissions": 100,
        "status": "solved"
      }
    ],
    "total": 50,
    "page": 1,
    "per_page": 20
  }
}
```

#### 5. è·å–é¢˜ç›®è¯¦æƒ…

```
GET /coding/api/questions/<question_id>
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "status": "success",
  "data": {
    "id": 1,
    "title": "ä¸¤æ•°ä¹‹å’Œ",
    "description": "ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„...",
    "subject_id": 1,
    "subject_name": "ç®—æ³•",
    "difficulty": "easy",
    "examples": [
      {
        "input": "nums = [2,7,11,15], target = 9",
        "output": "[0,1]",
        "explanation": "å› ä¸º nums[0] + nums[1] == 9"
      }
    ],
    "constraints": ["2 <= nums.length <= 10^4"],
    "code_template": "def twoSum(nums, target):\n    pass",
    "programming_language": "python",
    "time_limit": 5,
    "memory_limit": 128
  }
}
```

#### 6. è·å–é¢˜ç›®æ’å

```
GET /coding/api/questions/<question_id>/rankings?page=<page>&per_page=<per_page>
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "status": "success",
  "data": {
    "rankings": [
      {
        "rank": 1,
        "user_id": 1,
        "username": "user1",
        "best_score": 100.0,
        "accepted_score": 100.0,
        "best_time": 0.123,
        "total_submissions": 5,
        "last_submitted_at": "2025-01-29 10:30:00"
      }
    ],
    "total": 50,
    "page": 1,
    "per_page": 20,
    "user_rank": 5
  }
}
```

### ä»£ç æ‰§è¡ŒAPI

#### 7. è¿è¡Œä»£ç ï¼ˆæµ‹è¯•ç”¨ä¾‹ï¼‰

```
POST /coding/api/execute
Content-Type: application/json
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "code": "print('Hello')",
  "language": "python",
  "input": "1\n2",
  "time_limit": 5,
  "memory_limit": 128
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "status": "success",
  "data": {
    "output": "Hello\n",
    "error": null,
    "execution_time": 0.05,
    "status": "success"
  }
}
```

**é™æµï¼š** 10æ¬¡/åˆ†é’Ÿ

#### 8. æäº¤ä»£ç ï¼ˆè‡ªåŠ¨åˆ¤é¢˜ï¼‰

```
POST /coding/api/submit
Content-Type: application/json
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "question_id": 1,
  "code": "def twoSum(nums, target):\n    ...",
  "language": "python"
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "status": "success",
  "data": {
    "submission_id": 123,
    "status": "accepted",
    "passed_cases": 5,
    "total_cases": 5,
    "execution_time": 0.12,
    "score": 100.0,
    "error_message": null
  }
}
```

**é™æµï¼š** 5æ¬¡/åˆ†é’Ÿ

**è¯´æ˜ï¼š**
- æäº¤åä¼šè‡ªåŠ¨ä¿å­˜åˆ° `code_submissions` è¡¨
- è‡ªåŠ¨è®¡ç®—å¾—åˆ†ï¼š`score = (passed_cases / total_cases) * 100`
- è‡ªåŠ¨æ›´æ–° `coding_statistics` è¡¨ï¼ˆç”¨æˆ·å¯¹é¢˜ç›®çš„ç»Ÿè®¡ï¼‰
- è‡ªåŠ¨æ›´æ–° `user_coding_stats` è¡¨ï¼ˆç”¨æˆ·æ•´ä½“ç»Ÿè®¡ï¼‰

### æäº¤å†å²API

#### 9. è·å–æäº¤å†å²

```
GET /coding/api/submissions?question_id=<id>&status=<status>&page=<page>&per_page=<per_page>
```

**æŸ¥è¯¢å‚æ•°ï¼š**
- `question_id` (å¯é€‰): é¢˜ç›®ID
- `status` (å¯é€‰): çŠ¶æ€ç­›é€‰
- `page` (å¯é€‰): é¡µç ï¼Œé»˜è®¤1
- `per_page` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "status": "success",
  "data": {
    "submissions": [
      {
        "id": 123,
        "question_id": 1,
        "question_title": "ä¸¤æ•°ä¹‹å’Œ",
        "code": "def twoSum(nums, target):...",
        "language": "python",
        "status": "accepted",
        "passed_cases": 5,
        "total_cases": 5,
        "score": 100.0,
        "execution_time": 0.12,
        "submitted_at": "2025-01-29 10:30:00"
      }
    ],
    "total": 50,
    "page": 1,
    "per_page": 20
  }
}
```

#### 10. è·å–æäº¤è¯¦æƒ…

```
GET /coding/api/submissions/<submission_id>
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "status": "success",
  "data": {
    "id": 123,
    "question_id": 1,
    "question_title": "ä¸¤æ•°ä¹‹å’Œ",
    "code": "def twoSum(nums, target):...",
    "language": "python",
    "status": "accepted",
    "passed_cases": 5,
    "total_cases": 5,
    "score": 100.0,
    "execution_time": 0.12,
    "error_message": null,
    "submitted_at": "2025-01-29 10:30:00"
  }
}
```

### ç»Ÿè®¡API

#### 11. è·å–ç”¨æˆ·ç»Ÿè®¡

```
GET /coding/api/statistics
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "status": "success",
  "data": {
    "total_submissions": 150,
    "accepted_submissions": 120,
    "total_questions": 50,
    "solved_questions": 30,
    "acceptance_rate": 0.80
  }
}
```

### ç®¡ç†ç«¯API

#### 12. è·å–é¢˜ç›®é›†åˆ—è¡¨ï¼ˆç®¡ç†ç«¯ï¼‰

```
GET /admin/coding/api/subjects
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "status": "success",
  "data": {
    "subjects": [
      {
        "id": 1,
        "name": "ç®—æ³•",
        "description": "ç®—æ³•é¢˜ç›®é›†",
        "is_locked": false,
        "created_at": "2025-01-29 10:00:00",
        "function_count": 10,
        "coding_count": 40,
        "total_count": 50
      }
    ]
  }
}
```

#### 13. åˆ›å»ºé¢˜ç›®é›†ï¼ˆç®¡ç†ç«¯ï¼‰

```
POST /admin/coding/api/subjects
Content-Type: application/json
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "name": "ç®—æ³•",
  "description": "ç®—æ³•é¢˜ç›®é›†",
  "is_locked": false
}
```

#### 14. è·å–é¢˜ç›®åˆ—è¡¨ï¼ˆç®¡ç†ç«¯ï¼‰

```
GET /admin/coding/api/questions?subject_id=<id>&q_type=<type>&difficulty=<level>&is_enabled=<bool>&keyword=<keyword>&page=<page>&per_page=<per_page>
```

**æŸ¥è¯¢å‚æ•°ï¼š**
- `subject_id` (å¯é€‰): é¢˜ç›®é›†ID
- `q_type` (å¯é€‰): é¢˜ç›®ç±»å‹ï¼ˆå‡½æ•°é¢˜/ç¼–ç¨‹é¢˜ï¼‰
- `difficulty` (å¯é€‰): éš¾åº¦ï¼ˆeasy/medium/hardï¼‰
- `is_enabled` (å¯é€‰): æ˜¯å¦å¯ç”¨ï¼ˆtrue/falseï¼‰
- `keyword` (å¯é€‰): æœç´¢å…³é”®è¯
- `page` (å¯é€‰): é¡µç ï¼Œé»˜è®¤1
- `per_page` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20

#### 15. åˆ›å»ºé¢˜ç›®ï¼ˆç®¡ç†ç«¯ï¼‰

```
POST /admin/coding/api/questions
Content-Type: application/json
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "subject_id": 1,
  "title": "ä¸¤æ•°ä¹‹å’Œ",
  "q_type": "ç¼–ç¨‹é¢˜",
  "description": "ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„...",
  "difficulty": "easy",
  "code_template": "def twoSum(nums, target):\n    pass",
  "programming_language": "python",
  "time_limit": 5,
  "memory_limit": 128,
  "test_cases_json": "{\"test_cases\": [...]}",
  "is_enabled": true
}
```

---

## æ•°æ®åº“è®¾è®¡

### æ•°æ®è¡¨

#### 1. `coding_subjects` è¡¨ï¼ˆé¢˜ç›®é›†/ç§‘ç›®è¡¨ï¼‰

**å­—æ®µè¯´æ˜ï¼š**
- `id` (INTEGER PRIMARY KEY): é¢˜ç›®é›†ID
- `name` (TEXT NOT NULL): é¢˜ç›®é›†åç§°
- `description` (TEXT): é¢˜ç›®é›†æè¿°
- `is_locked` (INTEGER DEFAULT 0): æ˜¯å¦é”å®šï¼ˆ0=æœªé”å®šï¼Œ1=é”å®šï¼‰
- `created_at` (DATETIME DEFAULT CURRENT_TIMESTAMP): åˆ›å»ºæ—¶é—´

**è¯´æ˜ï¼š**
- è¿™æ˜¯ç¼–ç¨‹é¢˜æ¨¡å—ä¸“ç”¨çš„é¢˜ç›®é›†è¡¨ï¼Œä¸é€šç”¨çš„ `subjects` è¡¨ç‹¬ç«‹
- æ¯ä¸ªé¢˜ç›®é›†å¯ä»¥åŒ…å«å¤šä¸ªé¢˜ç›®ï¼ˆå‡½æ•°é¢˜å’Œç¼–ç¨‹é¢˜ï¼‰

#### 2. `coding_questions` è¡¨ï¼ˆé¢˜ç›®è¡¨ï¼‰

**å­—æ®µè¯´æ˜ï¼š**
- `id` (INTEGER PRIMARY KEY): é¢˜ç›®ID
- `coding_subject_id` (INTEGER NOT NULL): æ‰€å±é¢˜ç›®é›†IDï¼ˆå¤–é”®ï¼‰
- `title` (TEXT NOT NULL): é¢˜ç›®æ ‡é¢˜
- `q_type` (TEXT NOT NULL): é¢˜ç›®ç±»å‹ï¼ˆ'å‡½æ•°é¢˜' æˆ– 'ç¼–ç¨‹é¢˜'ï¼‰
- `description` (TEXT NOT NULL): é¢˜ç›®æè¿°
- `difficulty` (TEXT NOT NULL): éš¾åº¦ç­‰çº§ï¼ˆ'easy'/'medium'/'hard'ï¼‰
- `code_template` (TEXT): ä»£ç æ¨¡æ¿
- `programming_language` (TEXT DEFAULT "python"): ç¼–ç¨‹è¯­è¨€
- `time_limit` (INTEGER DEFAULT 5): æ—¶é—´é™åˆ¶ï¼ˆç§’ï¼‰
- `memory_limit` (INTEGER DEFAULT 128): å†…å­˜é™åˆ¶ï¼ˆMBï¼‰
- `test_cases_json` (TEXT NOT NULL): æµ‹è¯•ç”¨ä¾‹ï¼ˆJSONæ ¼å¼ï¼‰
- `examples` (TEXT): ç¤ºä¾‹è¯´æ˜
- `constraints` (TEXT): çº¦æŸæ¡ä»¶
- `hints` (TEXT): æç¤ºä¿¡æ¯
- `is_enabled` (INTEGER DEFAULT 1): æ˜¯å¦å¯ç”¨ï¼ˆ0/1ï¼‰
- `created_at` (DATETIME DEFAULT CURRENT_TIMESTAMP): åˆ›å»ºæ—¶é—´

**è¯´æ˜ï¼š**
- è¿™æ˜¯ç¼–ç¨‹é¢˜æ¨¡å—ä¸“ç”¨çš„é¢˜ç›®è¡¨ï¼Œä¸é€šç”¨çš„ `questions` è¡¨ç‹¬ç«‹
- æ”¯æŒä¸¤ç§é¢˜ç›®ç±»å‹ï¼šå‡½æ•°é¢˜å’Œç¼–ç¨‹é¢˜
- é€šè¿‡ `coding_subject_id` å…³è”åˆ° `coding_subjects` è¡¨

#### 3. `code_submissions` è¡¨ï¼ˆæäº¤è®°å½•è¡¨ï¼‰

**å­—æ®µè¯´æ˜ï¼š**
- `id` (INTEGER PRIMARY KEY): æäº¤ID
- `user_id` (INTEGER NOT NULL): ç”¨æˆ·IDï¼ˆå¤–é”®ï¼‰
- `question_id` (INTEGER NOT NULL): é¢˜ç›®IDï¼ˆå¤–é”®ï¼Œå¼•ç”¨ `coding_questions.id`ï¼‰
- `code` (TEXT NOT NULL): æäº¤çš„ä»£ç 
- `language` (TEXT NOT NULL): ç¼–ç¨‹è¯­è¨€
- `status` (TEXT NOT NULL): æäº¤çŠ¶æ€
  - `accepted`: é€šè¿‡
  - `wrong_answer`: ç­”æ¡ˆé”™è¯¯
  - `time_limit_exceeded`: è¶…æ—¶
  - `runtime_error`: è¿è¡Œæ—¶é”™è¯¯
  - `compilation_error`: ç¼–è¯‘é”™è¯¯
- `passed_cases` (INTEGER DEFAULT 0): é€šè¿‡çš„æµ‹è¯•ç”¨ä¾‹æ•°
- `total_cases` (INTEGER DEFAULT 0): æ€»æµ‹è¯•ç”¨ä¾‹æ•°
- `execution_time` (REAL): æ‰§è¡Œæ—¶é—´ï¼ˆç§’ï¼‰
- `error_message` (TEXT): é”™è¯¯ä¿¡æ¯
- `score` (REAL DEFAULT 0.0): å¾—åˆ†ï¼ˆ0-100åˆ†ï¼Œè®¡ç®—å…¬å¼ï¼špassed_cases / total_cases * 100ï¼‰
- `submitted_at` (DATETIME DEFAULT CURRENT_TIMESTAMP): æäº¤æ—¶é—´

**ç´¢å¼•ï¼š**
- `user_id`, `question_id`
- `submitted_at`

#### 4. `coding_statistics` è¡¨ï¼ˆç”¨æˆ·å¯¹é¢˜ç›®çš„ç»Ÿè®¡è¡¨ï¼‰

**å­—æ®µè¯´æ˜ï¼š**
- `id` (INTEGER PRIMARY KEY): ç»Ÿè®¡ID
- `user_id` (INTEGER NOT NULL): ç”¨æˆ·IDï¼ˆå¤–é”®ï¼‰
- `question_id` (INTEGER NOT NULL): é¢˜ç›®IDï¼ˆå¤–é”®ï¼Œå¼•ç”¨ `coding_questions.id`ï¼‰
- `total_submissions` (INTEGER DEFAULT 0): æ€»æäº¤æ¬¡æ•°
- `accepted_submissions` (INTEGER DEFAULT 0): é€šè¿‡æ¬¡æ•°
- `best_time` (REAL): æœ€ä½³æ‰§è¡Œæ—¶é—´ï¼ˆç§’ï¼‰
- `best_score` (REAL DEFAULT 0.0): æœ€ä½³å¾—åˆ†
- `first_accepted_at` (DATETIME): é¦–æ¬¡é€šè¿‡æ—¶é—´
- `last_submitted_at` (DATETIME): æœ€åæäº¤æ—¶é—´
- `updated_at` (DATETIME DEFAULT CURRENT_TIMESTAMP): æ›´æ–°æ—¶é—´

**å”¯ä¸€çº¦æŸï¼š**
- `(user_id, question_id)` - æ¯ä¸ªç”¨æˆ·å¯¹æ¯é“é¢˜åªæœ‰ä¸€æ¡ç»Ÿè®¡è®°å½•

**è¯´æ˜ï¼š**
- ç”¨äºå¿«é€ŸæŸ¥è¯¢ç”¨æˆ·å¯¹ç‰¹å®šé¢˜ç›®çš„ç»Ÿè®¡ä¿¡æ¯
- æ¯æ¬¡æäº¤æ—¶è‡ªåŠ¨æ›´æ–°

#### 5. `user_coding_stats` è¡¨ï¼ˆç”¨æˆ·æ•´ä½“ç»Ÿè®¡è¡¨ï¼‰

**å­—æ®µè¯´æ˜ï¼š**
- `id` (INTEGER PRIMARY KEY): ç»Ÿè®¡ID
- `user_id` (INTEGER NOT NULL UNIQUE): ç”¨æˆ·IDï¼ˆå¤–é”®ï¼Œå”¯ä¸€ï¼‰
- `total_submissions` (INTEGER DEFAULT 0): æ€»æäº¤æ¬¡æ•°
- `accepted_submissions` (INTEGER DEFAULT 0): é€šè¿‡æ¬¡æ•°
- `solved_questions` (INTEGER DEFAULT 0): å·²è§£å†³é¢˜ç›®æ•°ï¼ˆå»é‡ï¼‰
- `total_score` (REAL DEFAULT 0.0): æ€»å¾—åˆ†ï¼ˆæ‰€æœ‰æäº¤çš„å¾—åˆ†ä¹‹å’Œï¼‰
- `average_score` (REAL DEFAULT 0.0): å¹³å‡å¾—åˆ†
- `acceptance_rate` (REAL DEFAULT 0.0): é€šè¿‡ç‡ï¼ˆaccepted_submissions / total_submissionsï¼‰
- `updated_at` (DATETIME DEFAULT CURRENT_TIMESTAMP): æ›´æ–°æ—¶é—´

**è¯´æ˜ï¼š**
- ç”¨äºå¿«é€ŸæŸ¥è¯¢ç”¨æˆ·æ•´ä½“ç¼–ç¨‹ç»Ÿè®¡ä¿¡æ¯
- æ¯æ¬¡æäº¤æ—¶è‡ªåŠ¨æ›´æ–°
- æ¯ä¸ªç”¨æˆ·åªæœ‰ä¸€æ¡è®°å½•

### è¡¨å…³ç³»å›¾

```
coding_subjects (é¢˜ç›®é›†)
    â”‚
    â”œâ”€â”€ 1:N â”€â”€â†’ coding_questions (é¢˜ç›®)
    â”‚              â”‚
    â”‚              â””â”€â”€ 1:N â”€â”€â†’ code_submissions (æäº¤è®°å½•)
    â”‚                              â”‚
    â”‚                              â””â”€â”€ 1:1 â”€â”€â†’ coding_statistics (ç”¨æˆ·å¯¹é¢˜ç›®ç»Ÿè®¡)
    â”‚
    â””â”€â”€ 1:1 â”€â”€â†’ user_coding_stats (ç”¨æˆ·æ•´ä½“ç»Ÿè®¡)
```

---

## æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. ä»£ç æ‰§è¡ŒæœåŠ¡ (`code_executor.py`)

**åŠŸèƒ½ï¼š**
- å®‰å…¨æ‰§è¡Œç”¨æˆ·ä»£ç 
- æ—¶é—´é™åˆ¶æ§åˆ¶
- å†…å­˜é™åˆ¶æ§åˆ¶ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- è¾“å‡ºæˆªæ–­ï¼ˆé˜²æ­¢è¿‡é•¿è¾“å‡ºï¼‰

**å®ç°è¦ç‚¹ï¼š**
- å¼€å‘ç¯å¢ƒï¼šä½¿ç”¨ `subprocess` æ‰§è¡Œ
- ç”Ÿäº§ç¯å¢ƒï¼šä½¿ç”¨ Docker å®¹å™¨éš”ç¦»æ‰§è¡Œ
- è¶…æ—¶å¤„ç†ï¼šä½¿ç”¨ `subprocess.communicate(timeout=...)`
- è¾“å‡ºé™åˆ¶ï¼šé™åˆ¶è¾“å‡ºé•¿åº¦ï¼ˆå¦‚10000å­—ç¬¦ï¼‰

### 2. åˆ¤é¢˜æœåŠ¡ (`judge_service.py`)

**åŠŸèƒ½ï¼š**
- è§£ææµ‹è¯•ç”¨ä¾‹ï¼ˆJSONæ ¼å¼ï¼‰
- æ‰§è¡Œä»£ç å¹¶éªŒè¯è¾“å‡º
- æ¯”è¾ƒå®é™…è¾“å‡ºä¸æœŸæœ›è¾“å‡º
- ç”Ÿæˆåˆ¤é¢˜ç»“æœ

**åˆ¤é¢˜æµç¨‹ï¼š**
1. è§£æé¢˜ç›®æµ‹è¯•ç”¨ä¾‹ï¼ˆå…¬å¼€æµ‹è¯•ç”¨ä¾‹ + éšè—æµ‹è¯•ç”¨ä¾‹ï¼‰
2. å¯¹æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼š
   - æ‰§è¡Œä»£ç ï¼ˆè¾“å…¥æµ‹è¯•ç”¨ä¾‹çš„inputï¼‰
   - è·å–å®é™…è¾“å‡º
   - ä¸æœŸæœ›è¾“å‡ºæ¯”è¾ƒï¼ˆå»é™¤é¦–å°¾ç©ºç™½ã€æ¢è¡Œç¬¦ï¼‰
   - è®°å½•ç»“æœ
3. ç»Ÿè®¡é€šè¿‡ç”¨ä¾‹æ•°
4. è®¡ç®—å¾—åˆ†ï¼š`score = (passed_cases / total_cases) * 100`
5. ç”Ÿæˆæäº¤è®°å½•

**è¾“å‡ºæ¯”è¾ƒè§„åˆ™ï¼š**
- å»é™¤é¦–å°¾ç©ºç™½å­—ç¬¦
- å»é™¤æœ«å°¾æ¢è¡Œç¬¦
- é€è¡Œæ¯”è¾ƒï¼ˆå¯é€‰ï¼šä¸¥æ ¼æ¨¡å¼ï¼‰

### 3. é¢˜ç›®æœåŠ¡ (`question_service.py`)

**åŠŸèƒ½ï¼š**
- é¢˜ç›®CRUDæ“ä½œï¼ˆä½¿ç”¨ `coding_questions` è¡¨ï¼‰
- é¢˜ç›®æŸ¥è¯¢ä¸ç­›é€‰
- é¢˜ç›®ç»Ÿè®¡ä¿¡æ¯è®¡ç®—
- æ”¯æŒå‡½æ•°é¢˜å’Œç¼–ç¨‹é¢˜ä¸¤ç§ç±»å‹

**å…³é”®æ–¹æ³•ï¼š**
- `get_questions()` - è·å–é¢˜ç›®åˆ—è¡¨ï¼ˆæ”¯æŒç­›é€‰ã€åˆ†é¡µï¼‰
- `get_question()` - è·å–é¢˜ç›®è¯¦æƒ…
- `create_question()` - åˆ›å»ºé¢˜ç›®
- `update_question()` - æ›´æ–°é¢˜ç›®
- `delete_question()` - åˆ é™¤é¢˜ç›®
- `calculate_statistics()` - è®¡ç®—é¢˜ç›®ç»Ÿè®¡ä¿¡æ¯

### 4. æäº¤æœåŠ¡ (`submission_service.py`)

**åŠŸèƒ½ï¼š**
- æäº¤è®°å½•CRUD
- æäº¤å†å²æŸ¥è¯¢ï¼ˆåˆ†é¡µã€ç­›é€‰ï¼‰
- æäº¤ç»Ÿè®¡è®¡ç®—
- æœ€ä½³æäº¤è®°å½•æŸ¥è¯¢
- **è‡ªåŠ¨æ›´æ–°ç»Ÿè®¡è¡¨**ï¼š
  - æ›´æ–° `coding_statistics`ï¼ˆç”¨æˆ·å¯¹é¢˜ç›®çš„ç»Ÿè®¡ï¼‰
  - æ›´æ–° `user_coding_stats`ï¼ˆç”¨æˆ·æ•´ä½“ç»Ÿè®¡ï¼‰

**å…³é”®æ–¹æ³•ï¼š**
- `create_submission()` - åˆ›å»ºæäº¤è®°å½•å¹¶æ›´æ–°ç»Ÿè®¡
- `get_submissions()` - è·å–æäº¤å†å²
- `get_submission()` - è·å–æäº¤è¯¦æƒ…
- `get_best_submission()` - è·å–æœ€ä½³æäº¤è®°å½•
- `get_user_statistics()` - è·å–ç”¨æˆ·ç»Ÿè®¡ä¿¡æ¯
- `_update_question_statistics()` - æ›´æ–°é¢˜ç›®çº§åˆ«ç»Ÿè®¡ï¼ˆç§æœ‰æ–¹æ³•ï¼‰
- `_update_user_statistics()` - æ›´æ–°ç”¨æˆ·æ•´ä½“ç»Ÿè®¡ï¼ˆç§æœ‰æ–¹æ³•ï¼‰

**ç»Ÿè®¡æ›´æ–°é€»è¾‘ï¼š**
1. æ¯æ¬¡æäº¤æ—¶ï¼Œè‡ªåŠ¨è®¡ç®—å¾—åˆ†
2. æ›´æ–° `coding_statistics` è¡¨ï¼š
   - å¢åŠ æ€»æäº¤æ¬¡æ•°
   - å¦‚æœé€šè¿‡ï¼Œå¢åŠ é€šè¿‡æ¬¡æ•°
   - æ›´æ–°æœ€ä½³æ—¶é—´å’Œæœ€ä½³å¾—åˆ†
   - è®°å½•é¦–æ¬¡é€šè¿‡æ—¶é—´
3. æ›´æ–° `user_coding_stats` è¡¨ï¼š
   - æ›´æ–°æ€»æäº¤æ¬¡æ•°å’Œé€šè¿‡æ¬¡æ•°
   - æ›´æ–°å·²è§£å†³é¢˜ç›®æ•°ï¼ˆå»é‡ï¼‰
   - æ›´æ–°æ€»å¾—åˆ†å’Œå¹³å‡å¾—åˆ†
   - æ›´æ–°é€šè¿‡ç‡

---

## UIè®¾è®¡è§„èŒƒ

### è®¾è®¡é£æ ¼

- **å‚è€ƒå¹³å°**ï¼šPTAï¼ˆç¨‹åºè®¾è®¡ç±»å®éªŒè¾…åŠ©æ•™å­¦å¹³å°ï¼‰
- **é£æ ¼**ï¼šiOS 18é£æ ¼ï¼Œæ¯›ç»ç’ƒæ•ˆæœï¼Œåœ†è§’è®¾è®¡
- **é¢œè‰²æ–¹æ¡ˆ**ï¼š
  - ä¸»è‰²ï¼š`#007AFF` (iOS Blue)
  - æˆåŠŸï¼š`#34c759` (Green)
  - è­¦å‘Šï¼š`#ff9500` (Orange)
  - å±é™©ï¼š`#ff3b30` (Red)
  - èƒŒæ™¯ï¼š`#f5f5f7` (æµ…ç°)
  - æ–‡å­—ï¼š`#1d1d1f` (æ·±ç°)

### å¸ƒå±€ç‰¹ç‚¹

1. **ä¸‰æ å¸ƒå±€**ï¼ˆé¢˜ç›®è¯¦æƒ…é¡µï¼‰ï¼š
   - å·¦ä¾§ï¼šå¯¼èˆªæ ï¼ˆå¯æ”¶èµ·/å±•å¼€ï¼Œå®½åº¦240px/60pxï¼‰
   - ä¸­é—´ï¼šé¢˜ç›®æè¿°åŒºåŸŸ
   - å³ä¾§ï¼šä»£ç ç¼–è¾‘å™¨

2. **ä¾§è¾¹æ è®¾è®¡**ï¼š
   - å±•å¼€å®½åº¦ï¼š240pxï¼ˆç¡®ä¿æ–‡å­—å®Œå…¨å¯è§ï¼‰
   - æ”¶èµ·å®½åº¦ï¼š60pxï¼ˆä»…æ˜¾ç¤ºå›¾æ ‡ï¼‰
   - å›¾æ ‡åœ¨ä¸Šï¼Œæ–‡å­—åœ¨ä¸‹ï¼ˆå‚ç›´å¸ƒå±€ï¼‰
   - æ”¯æŒæ”¶èµ·/å±•å¼€åˆ‡æ¢ï¼ˆçŠ¶æ€ä¿å­˜åˆ°LocalStorageï¼‰

3. **å“åº”å¼è®¾è®¡**ï¼š
   - ç§»åŠ¨ç«¯ï¼šå•æ å¸ƒå±€
   - å¹³æ¿ï¼šä¸¤æ å¸ƒå±€
   - æ¡Œé¢ï¼šä¸‰æ å¸ƒå±€

### ç»„ä»¶è§„èŒƒ

- **æŒ‰é’®**ï¼šåœ†è§’12pxï¼Œæ¯›ç»ç’ƒèƒŒæ™¯
- **å¡ç‰‡**ï¼šåœ†è§’18pxï¼Œé˜´å½±æ•ˆæœ
- **è¾“å…¥æ¡†**ï¼šåœ†è§’12pxï¼Œè¾¹æ¡†0.5px
- **å¯¼èˆªé¡¹**ï¼šå›¾æ ‡24x24pxï¼Œæ–‡å­—11px
- **å¾—åˆ†æ˜¾ç¤º**ï¼šä½¿ç”¨åˆ†æ•°æ ¼å¼ï¼ˆ0-100åˆ†ï¼‰ï¼Œä¸æ˜¯ç™¾åˆ†æ¯”

---

## ä½¿ç”¨æŒ‡å—

### ç”¨æˆ·ä½¿ç”¨æµç¨‹

1. **æŸ¥çœ‹é¢˜ç›®é›†åˆ—è¡¨**
   - è®¿é—® `/coding`
   - æŸ¥çœ‹æ‰€æœ‰é¢˜ç›®é›†åŠå…¶ç»Ÿè®¡ä¿¡æ¯
   - ç‚¹å‡»"æŸ¥çœ‹"æŒ‰é’®è¿›å…¥é¢˜ç›®é›†æ¦‚è¿°é¡µ

2. **æŸ¥çœ‹é¢˜ç›®é›†æ¦‚è¿°**
   - æŸ¥çœ‹é¢˜ç›®é›†è¯¦ç»†ä¿¡æ¯
   - æŸ¥çœ‹è‡ªå·±çš„å¾—åˆ†ã€æ’åã€è¿›åº¦
   - æŸ¥çœ‹æŒ‰éš¾åº¦åˆ†ç±»çš„é¢˜ç›®ç»Ÿè®¡
   - ç‚¹å‡»"ç»§ç»­ç­”é¢˜"æˆ–"é¢˜ç›®åˆ—è¡¨"è¿›å…¥é¢˜ç›®åˆ—è¡¨

3. **æŸ¥çœ‹é¢˜ç›®åˆ—è¡¨**
   - æŸ¥çœ‹è¯¥é¢˜ç›®é›†ä¸‹çš„æ‰€æœ‰é¢˜ç›®
   - ä½¿ç”¨ç­›é€‰å™¨ï¼ˆéš¾åº¦ã€çŠ¶æ€ï¼‰ç­›é€‰é¢˜ç›®
   - ä½¿ç”¨æœç´¢æ¡†æœç´¢é¢˜ç›®
   - ç‚¹å‡»é¢˜ç›®è¿›å…¥è¯¦æƒ…é¡µ

4. **åšé¢˜**
   - æŸ¥çœ‹é¢˜ç›®æè¿°ã€ç¤ºä¾‹ã€çº¦æŸæ¡ä»¶
   - åœ¨å³ä¾§ä»£ç ç¼–è¾‘å™¨ç¼–å†™ä»£ç 
   - ç‚¹å‡»"æµ‹è¯•ç”¨ä¾‹"è¿è¡Œä»£ç ï¼ˆä¸åˆ¤é¢˜ï¼‰
   - ç‚¹å‡»"æäº¤æœ¬é¢˜ä½œç­”"æäº¤ä»£ç è¿›è¡Œåˆ¤é¢˜
   - æŸ¥çœ‹æäº¤ç»“æœå’Œå¾—åˆ†

5. **æŸ¥çœ‹æäº¤å†å²**
   - åœ¨é¢˜ç›®è¯¦æƒ…é¡µç‚¹å‡»"æäº¤åˆ—è¡¨"
   - æˆ–åœ¨é¢˜ç›®åˆ—è¡¨é¡µç‚¹å‡»"æäº¤åˆ—è¡¨"
   - æŸ¥çœ‹æ‰€æœ‰æäº¤è®°å½•ï¼ŒåŒ…æ‹¬å¾—åˆ†ã€é€šè¿‡æµ‹è¯•ç”¨ä¾‹æ•°ã€æ‰§è¡Œæ—¶é—´

6. **æŸ¥çœ‹æ’å**
   - åœ¨é¢˜ç›®è¯¦æƒ…é¡µç‚¹å‡»"æ’å"
   - æŸ¥çœ‹è¯¥é¢˜ç›®çš„ç”¨æˆ·æ’å
   - æŸ¥çœ‹è‡ªå·±çš„æ’åä½ç½®å’Œæœ€ä½³å¾—åˆ†

### ç®¡ç†å‘˜ä½¿ç”¨æµç¨‹

1. **ç®¡ç†é¢˜ç›®é›†**
   - è®¿é—® `/admin/coding`ï¼Œåˆ‡æ¢åˆ°"é¢˜ç›®é›†ç®¡ç†"æ ‡ç­¾
   - æŸ¥çœ‹æ‰€æœ‰é¢˜ç›®é›†åˆ—è¡¨
   - åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤é¢˜ç›®é›†
   - è®¾ç½®é¢˜ç›®é›†é”å®šçŠ¶æ€

2. **ç®¡ç†é¢˜ç›®**
   - è®¿é—® `/admin/coding`ï¼Œåˆ‡æ¢åˆ°"é¢˜ç›®ç®¡ç†"æ ‡ç­¾
   - æˆ–è®¿é—® `/admin/coding/questions?subject_id=<id>` ç®¡ç†æŒ‡å®šé¢˜ç›®é›†çš„é¢˜ç›®
   - æŸ¥çœ‹æ‰€æœ‰é¢˜ç›®åˆ—è¡¨
   - åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤é¢˜ç›®
   - è®¾ç½®é¢˜ç›®ç±»å‹ï¼ˆå‡½æ•°é¢˜/ç¼–ç¨‹é¢˜ï¼‰
   - è®¾ç½®é¢˜ç›®çŠ¶æ€ï¼ˆå¯ç”¨/ç¦ç”¨ï¼‰
   - æŸ¥çœ‹é¢˜ç›®ç»Ÿè®¡ï¼ˆæäº¤æ¬¡æ•°ã€é€šè¿‡ç‡ï¼‰

---

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°åŠŸèƒ½

1. **æ·»åŠ æ–°é¡µé¢**ï¼š
   - åœ¨ `routes/pages.py` æ·»åŠ è·¯ç”±
   - åœ¨ `templates/coding/` åˆ›å»ºæ¨¡æ¿æ–‡ä»¶
   - å‚è€ƒç°æœ‰é¡µé¢çš„æ ·å¼å’Œç»“æ„

2. **æ·»åŠ æ–°API**ï¼š
   - åœ¨ `routes/api.py` æ·»åŠ APIç«¯ç‚¹
   - ä½¿ç”¨ `@login_required` è£…é¥°å™¨ä¿æŠ¤
   - ä½¿ç”¨ Pydantic Schema éªŒè¯è¾“å…¥
   - è¿”å›ç»Ÿä¸€çš„JSONæ ¼å¼

3. **æ·»åŠ æ–°æœåŠ¡**ï¼š
   - åœ¨ `services/` ç›®å½•åˆ›å»ºæœåŠ¡æ–‡ä»¶
   - å®ç°ä¸šåŠ¡é€»è¾‘
   - åœ¨APIè·¯ç”±ä¸­è°ƒç”¨æœåŠ¡

### ä»£ç è§„èŒƒ

1. **ç±»å‹æç¤º**ï¼šæ‰€æœ‰å‡½æ•°å¿…é¡»ä½¿ç”¨ç±»å‹æç¤º
2. **é”™è¯¯å¤„ç†**ï¼šä½¿ç”¨ try-except æ•è·å¼‚å¸¸
3. **æ—¥å¿—è®°å½•**ï¼šä½¿ç”¨ `current_app.logger` è®°å½•æ—¥å¿—
4. **æ•°æ®åº“æŸ¥è¯¢**ï¼š
   - ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢é˜²æ­¢SQLæ³¨å…¥
   - æ³¨æ„ `sqlite3.Row` å¯¹è±¡ä¸æ”¯æŒ `.get()` æ–¹æ³•ï¼Œéœ€è¦å…ˆè½¬æ¢ä¸ºå­—å…¸
5. **æ•°æ®è¡¨ä½¿ç”¨**ï¼š
   - ç¼–ç¨‹é¢˜ç›¸å…³æ•°æ®å¿…é¡»ä½¿ç”¨ `coding_subjects` å’Œ `coding_questions` è¡¨
   - ä¸è¦ä½¿ç”¨é€šç”¨çš„ `subjects` å’Œ `questions` è¡¨

### æ•°æ®åº“æ“ä½œæ³¨æ„äº‹é¡¹

1. **sqlite3.Row å¯¹è±¡**ï¼š
   - `sqlite3.Row` å¯¹è±¡ä¸æ”¯æŒ `.get()` æ–¹æ³•
   - éœ€è¦å…ˆè½¬æ¢ä¸ºå­—å…¸ï¼š`row_dict = dict(row)`
   - ç„¶åä½¿ç”¨ `row_dict.get('field_name', default_value)`

2. **å­—æ®µè®¿é—®**ï¼š
   - ä½¿ç”¨ `coding_questions` è¡¨æ—¶ï¼Œå­—æ®µåä¸º `title` å’Œ `description`ï¼ˆä¸æ˜¯ `content` å’Œ `explanation`ï¼‰
   - ä½¿ç”¨ `coding_subjects` è¡¨æ—¶ï¼Œå­—æ®µåä¸º `coding_subject_id`ï¼ˆä¸æ˜¯ `subject_id`ï¼‰

3. **ç»Ÿè®¡æ›´æ–°**ï¼š
   - æ¯æ¬¡åˆ›å»ºæäº¤è®°å½•æ—¶ï¼Œä¼šè‡ªåŠ¨æ›´æ–°ç»Ÿè®¡è¡¨
   - ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨ç»Ÿè®¡æ›´æ–°æ–¹æ³•

### æµ‹è¯•å»ºè®®

1. **å•å…ƒæµ‹è¯•**ï¼šæµ‹è¯•æœåŠ¡å±‚å‡½æ•°
2. **é›†æˆæµ‹è¯•**ï¼šæµ‹è¯•APIç«¯ç‚¹
3. **å‰ç«¯æµ‹è¯•**ï¼šæµ‹è¯•é¡µé¢äº¤äº’
4. **æ•°æ®åº“æµ‹è¯•**ï¼šéªŒè¯æ•°æ®è¿ç§»å’Œç»Ÿè®¡æ›´æ–°

---

## æ›´æ–°æ—¥å¿—

### v2.0 (2025-01-29)

**é‡å¤§æ›´æ–°ï¼š**
- âœ… åˆ›å»ºç‹¬ç«‹çš„æ•°æ®åº“è¡¨ç»“æ„ï¼ˆ`coding_subjects`ã€`coding_questions`ï¼‰
- âœ… å®ç°æ•°æ®è¿ç§»è„šæœ¬ï¼Œå°†ç°æœ‰ç¼–ç¨‹é¢˜æ•°æ®è¿ç§»åˆ°æ–°è¡¨
- âœ… æ›´æ–° `code_submissions` è¡¨å¼•ç”¨æ–°çš„ `coding_questions` è¡¨
- âœ… æ·»åŠ  `score` å­—æ®µåˆ° `code_submissions` è¡¨
- âœ… åˆ›å»º `coding_statistics` è¡¨ï¼ˆç”¨æˆ·å¯¹é¢˜ç›®çš„ç»Ÿè®¡ï¼‰
- âœ… åˆ›å»º `user_coding_stats` è¡¨ï¼ˆç”¨æˆ·æ•´ä½“ç»Ÿè®¡ï¼‰
- âœ… å®ç°è‡ªåŠ¨ç»Ÿè®¡æ›´æ–°åŠŸèƒ½ï¼ˆæ¯æ¬¡æäº¤æ—¶è‡ªåŠ¨æ›´æ–°ï¼‰
- âœ… æ›´æ–°æ‰€æœ‰APIå’Œå‰ç«¯é¡µé¢ä½¿ç”¨æ–°çš„æ•°æ®è¡¨
- âœ… ä¿®å¤ `sqlite3.Row` å¯¹è±¡è®¿é—®é—®é¢˜
- âœ… ä¿®å¤ç®¡ç†ç«¯é¢˜ç›®åˆ›å»ºå’Œåˆ—è¡¨åŠŸèƒ½
- âœ… æ›´æ–°å‰ç«¯æ˜¾ç¤ºå¾—åˆ†ä¿¡æ¯

**åŠŸèƒ½å®Œå–„ï¼š**
- âœ… å®ç°é¢˜ç›®é›†ç®¡ç†ï¼ˆåˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤ï¼‰
- âœ… å®ç°é¢˜ç›®ç®¡ç†ï¼ˆæ”¯æŒå‡½æ•°é¢˜å’Œç¼–ç¨‹é¢˜ä¸¤ç§ç±»å‹ï¼‰
- âœ… å®ç°æäº¤å†å²å’Œå¾—åˆ†æ˜¾ç¤º
- âœ… å®ç°æ’ååŠŸèƒ½ï¼ˆæŒ‰å¾—åˆ†æ’åºï¼‰
- âœ… å®ç°ç»Ÿè®¡åŠŸèƒ½ï¼ˆç”¨æˆ·å¯¹é¢˜ç›®ç»Ÿè®¡ã€ç”¨æˆ·æ•´ä½“ç»Ÿè®¡ï¼‰

### v1.0 (2025-01-29)

- âœ… å®ç°ç§‘ç›®é€‰æ‹©é¡µ
- âœ… å®ç°é¢˜ç›®é›†åˆ—è¡¨é¡µ
- âœ… å®ç°é¢˜ç›®é›†æ¦‚è¿°é¡µ
- âœ… å®ç°é¢˜ç›®åˆ—è¡¨é¡µ
- âœ… å®ç°é¢˜ç›®è¯¦æƒ…é¡µï¼ˆä¸‰æ å¸ƒå±€ï¼Œå¯æ”¶èµ·ä¾§è¾¹æ ï¼‰
- âœ… å®ç°æäº¤å†å²é¡µ
- âœ… å®ç°æ’åé¡µ
- âœ… å®ç°ä»£ç æ‰§è¡Œå’Œåˆ¤é¢˜åŠŸèƒ½
- âœ… å®ç°æäº¤è®°å½•ä¿å­˜

---

## å¾…å®ç°åŠŸèƒ½

- [ ] é¢˜ç›®æ”¶è—åŠŸèƒ½
- [ ] ä»£ç å¯¹æ¯”åŠŸèƒ½ï¼ˆä¸å†å²æäº¤å¯¹æ¯”ï¼‰
- [ ] è®¨è®ºåŒºï¼ˆé¢˜ç›®è¯„è®ºï¼‰
- [ ] æ›´å¤šç¼–ç¨‹è¯­è¨€æ”¯æŒï¼ˆJavaã€C++ï¼‰
- [ ] Dockerå®¹å™¨æ‰§è¡Œï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- [ ] ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–
- [ ] ä»£ç æ¨¡æ¿åº“
- [ ] é¢˜ç›®å¯¼å…¥/å¯¼å‡ºåŠŸèƒ½
- [ ] æ‰¹é‡æ“ä½œåŠŸèƒ½ï¼ˆæ‰¹é‡å¯ç”¨/ç¦ç”¨é¢˜ç›®ï¼‰

---

## å‚è€ƒèµ„æº

- [Monaco Editoræ–‡æ¡£](https://microsoft.github.io/monaco-editor/)
- [Flask-RESTfulæ–‡æ¡£](https://flask-restful.readthedocs.io/)
- [Pydanticæ–‡æ¡£](https://docs.pydantic.dev/)
- [PTAå¹³å°](https://pintia.cn/)

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv2.0  
**æœ€åæ›´æ–°**ï¼š2025-01-29  
**ç»´æŠ¤è€…**ï¼šå¼€å‘å›¢é˜Ÿ
